<head>
    <!-- Required meta tags -->   
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css"
      integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
      crossorigin="anonymous"
    />

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">

    <link rel="stylesheet" type="text/css" href="/../res/site/css/style.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.11/jquery.mask.min.js"></script>

    <title>Cursos Esportivos SBC</title>
    <link rel="icon" type="image/jpg" href="/../res/site/img/corpoacao.png" />

    <style type="text/css">
     
    @media print{
      @page{
          size: landscape;
      }
        #image-example{
            position: absolute;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            margin: auto;
      }
    }

    .div-center {
      padding: 20px;
      margin: 10px;
      border: solid 1px rgb(219, 219, 219);
    }

      /*
      @page land {
        size: landscape;
      }
        #landscape {
        page: land;
      }
      */

      body {
          margin: 10px;
          padding: 20px;
      }

       #div1 {
          display: flex;
      }

    

      table {          
          
          font-size: 8px; 
          border: 1px solid #000;
          flex-shrink:0;
          page-break-inside: avoid; 
      }
      tr:nth-child(even){
          background: lightgray;
      }
      

    </style>

</head>

<div id="div1">  
    <a href="javascript:window.history.go(-1)">
        <i class="fa fa-arrow-left"></i> 
            Voltar
    </a> 
    &nbsp;&nbsp;&nbsp;&nbsp;
    <a href="/admin">
        <i class="fa fa-home"></i> 
            Início
    </a>  
</div>


<div id="div1">

  <div class="div-center rounded">
    <h5 style="margin: 0 0 0 0">Lista de inscrições temporada    </h5>
        
      <table class="table table-bordered" id="table">
        
        <thead>
            <tr>
          <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">ID</th>

              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">Nome</th>

              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">Tipo Insc</th>

              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">DT NASC</th>

              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">Email</th>
              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">Whats/Fone</th>

              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">Responsável</th>
              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">Insc. status</th>

              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">CPF</th>
             
              <!--<th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">Endereço</th>-->
              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">Turma</th>
              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">Local</th>

              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">Data inscrição</th>

              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">Data matricula</th>
              
              </tr>
        </thead>
        {loop="$listapessoas"}
        <tbody>
          <tr style="padding: 5px"> 
              <td style="text-align: center; border: solid 1px; padding: 5px;">
                {$value.idpess}
              </td>              
              <td style="text-align: left; border: solid 1px; color: darkblue; padding: 5px;">
                {$value.nomepess}
              </td>
               <td style="text-align: center; border: solid 1px; padding: 5px;">
                {if="$value.inscpcd == 1"}
                PCD
                {/if}
                {if="$value.laudo == 1"}
                Laudo
                {/if}
                {if="$value.inscpvs == 1"}
                PVS
                {/if}
              </td>                                                                                                   
              <td style="text-align: left; border: solid 1px; color: darkblue; padding: 5px;">
                {function="formatDate($value.dtnasc)"}
              </td>
              <td style="text-align: left; border: solid 1px; color: darkblue; padding: 5px;">
                {$value.deslogin}
              </td>
              <td style="text-align: left; border: solid 1px; color: darkblue; padding: 5px;">
                
                <a href="https://wa.me/+55{$value.nrphone}?text=Olá%20{$value.nomepess},%20tudo%20bem?!" target="_blank" onclick="return confirm('Você será direcionado para o whatsapp com a msg de saudação')"><i></i>{$value.nrphone}</a>
              </td>
              <td style="text-align: center; border: solid 1px; padding: 5px;">
                {$value.desperson}
              </td>
              <td style="text-align: center; border: solid 1px; padding: 5px;">                
                {if="$value.idinscstatus == 1"}
                  <span style="color: black;"> Matriculada </span>
                {/if}                
                {if="$value.idinscstatus == 2"}
                  <span style="color: darkgreen;"> Aguard. Matrícula </span>
                {/if}
                {if="$value.idinscstatus == 7"}
                  <span style="color: darkblue;"> Lista Espera </span>
                {/if} 
                {if="$value.idinscstatus == 8"}
                  <span style="color: darkgray;"> Desistente </span>
                {/if} 
                {if="$value.idinscstatus == 9"}
                  <span style="color: red;"> Cancelada </span>
                {/if}                
              </td>
              <td style="text-align: center; border: solid 1px; padding: 5px;">
                {if="getUserId() == 1 OR getUserId() == 7 OR getUserId() == 156 OR getUserId() == 27659 OR getUserId() == 22284 OR getUserId() == 22023"}
                {$value.numcpf}
                {else}
                {function="formatCpf($value.numcpf)"}
                {/if}
              </td>
              
            <!-- 
              <td style="text-align: left; border: solid 1px; padding: 5px;">
                 {$value.cep} - {$value.rua} - {$value.numero} - {$value.complemento} - {$value.bairro}
              </td> 
            -->
              <td style="text-align: center; border: solid 1px; padding: 5px;">
                {$value.descturma}
              </td>
               <td style="text-align: center; border: solid 1px; padding: 5px;">
                {$value.apelidolocal}
              </td>
               <td style="text-align: center; border: solid 1px; padding: 5px;">
                {function="formatDateHour($value.dtinsc)"}
              </td>
              <td style="text-align: center; border: solid 1px; padding: 5px;">
                {function="formatDateHour($value.dtmatric)"}
              </td>        
                                                                             
          </tr>
          </tbody>
          {else}
          <tr style="font-weight: bold; color: red; font-size: 22px; text-align: center; padding: 10px;">
            <td colspan="26" style="padding: 10px">
              Não há turmas relacionadas a este local!
            </td>
          </tr>
          </tbody>
          {/loop}
        </tbody>
      </table>

      <button
        class="btn btn-primary"
        id="export-button"
        onclick="exportTableToXLS()"
      >
        Exportar para XLS
      </button>

      <button onclick="window.print()" class="btn btn-primary" style="">
                    <i class="fa fa-print"></i> Imprimir
              </button>
    </div>

</div>

<script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <script type="text/javascript">
      
      function exportTableToXLS() {

        const table = document.getElementById("table");
        const tableRows = table.getElementsByTagName("tr");
        const columnCount = tableRows[0].children.length;

        const worksheet = XLSX.utils.table_to_sheet(table);

        const workbook = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(
          workbook,
          worksheet,
          document.getElementById("title").textContent
        );

        const fileName = document.getElementById("title").textContent+".xlsx";

        XLSX.writeFile(workbook, fileName);
      }


    </script>





      
           
            
           
           