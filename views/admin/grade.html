
<head>
	<!-- Required meta tags -->   
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css"
      integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
      crossorigin="anonymous"
    />

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">

    <link rel="stylesheet" type="text/css" href="/../res/site/css/style.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.11/jquery.mask.min.js"></script>

    <title>Cursos Esportivos SBC</title>
    <link rel="icon" type="image/jpg" href="/../res/site/img/corpoacao.png" />

	<style type="text/css">
     
    @media print{
      @page{
          size: landscape;
      }
        #image-example{
            position: absolute;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            margin: auto;
      }
    }

    .div-center {
      padding: 20px;
      margin: 10px;
      border: solid 1px rgb(219, 219, 219);
    }

      /*
      @page land {
        size: landscape;
      }
        #landscape {
        page: land;
      }
      */

      body {
          margin: 10px;
          padding: 20px;
      }

       #div1 {
          display: flex;
      }

    

      table {          
          
          font-size: 12px; 
          border: 1px solid #000;
          flex-shrink:0;
          page-break-inside: avoid; 
      }
      tr:nth-child(even){
          background: lightgray;
      }
      

    </style>
    <script type="text/javascript">
    	
    function openGrade(idespaco) {

    	let id = idespaco;

    	alert(id);

    	document.getElementById('grade'+id).hidden = false

  	}
    </script>
</head>

  <div id="div1">  
      <a href="javascript:window.history.go(-1)">
          <i class="fa fa-arrow-left"></i> 
              Voltar
      </a> 
      &nbsp;&nbsp;&nbsp;&nbsp;
      <a href="/admin">
          <i class="fa fa-home"></i> 
              Início
      </a> 

       &nbsp;&nbsp;&nbsp;&nbsp;

      {loop="$espacos"}
  	<a href="/admin/gradehorarioespaco/{$temporada.idtemporada}/{$idlocal}/{$value.idespaco}" style="color: darkblue;">
           
              {$value.nomeespaco}
      </a> 
      &nbsp;&nbsp;&nbsp;&nbsp;
    {/loop}  
  	</div>
  
	<div class="div-center rounded">
		{loop="$espacos"}
		
		{$idespaco = $value.idespaco}
		<table id="table" style="border: solid 1px; padding: 20px; margin-bottom: 30px; font-size: 12px;">
				
			<thead>
				<tr>
					<td style="text-align: center; border: solid 1px;" colspan="8">
						<span style="font-size: 28px;">
							{$value.apelidolocal}
						</span>
						<span style="font-size: 20px;">
							( {$temporada.desctemporada} )
						</span><br>
						<span style="font-size: 10px;">
							{$nomelocal} - {$rua} - {$numero} - {$bairro} - {$telefone}
						</span><br>
						<span style="font-size: 20px; font-weight: bold;"> 
							Quadro de Atividades / {$value.nomeespaco}
						</span>
						
					</td>
				</tr>
				<tr>
					<th>
						
					</th>
					<th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px; width: 160px; background-color: #ccc; background-color: #ccc;">
						SEGUNDA-FEIRA
					</th>
					<th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px; width: 160px; background-color: #ccc;">
						TERÇA-FEIRA
					</th>
					<th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px; width: 160px; background-color: #ccc;">
						QUARTA-FEIRA
					</th>
					<th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px; width: 160px; background-color: #ccc;">
						QUINTA-FEIRA
					</th>
					<th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px; width: 160px; background-color: #ccc;">
						SEXTA-FEIRA
					</th>
					<th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px; width: 160px; background-color: #ccc;">
						SÁBADO
					</th>
					<th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px; width: 160px; background-color: #ccc;">
						DOMINGO
					</th>
				</tr>
				
			</thead>
			<tbody>
				<tr>
					<td style="background-color: #ccc">
						 <br>
						M<br><br>
						A<br><br>
						N<br><br>
						H<br><br>
						Â<br><br>
					</td>
					<td >
						<table>						
						{loop="$turmas"}
							{if="$value.periodo == 'Manhã'"}

								{if="$value.diasemana == 'Segunda' OR $value.diasemana == 'Segunda a Sexta' OR $value.diasemana == 'Segunda e Quarta' OR $value.diasemana == 'Segunda e Quinta'"}

									{if="$idespaco == $value.idespaco"}
										<tr style="height: 70px;">
											<td style="border: solid 1px; text-align: center; padding: 5px; width: 160px; ">
													{$value.descturma}<br>
													{$value.apelidoperson} / Estagiário<br>
													<span style="font-weight: bold;">
														{$value.horainicio} às {$value.horatermino}
													</span>
													<br>{$value.diasemana}-{$value.periodo}					
											</td>
										</tr>
									{/if}

								{/if}

							{/if}
						{/loop}
						</table>						
					</td>
					<td >
						<table>						
						{$idespaco = $value.idespaco}
						{loop="$turmas"}
							{if="$value.periodo == 'Manhã'"}

								{if="$value.diasemana == 'Terça' OR $value.diasemana == 'Terça e Quinta' OR $value.diasemana == 'Terça a Quinta' OR $value.diasemana == 'Terça e Sexta' OR $value.diasemana == 'Terça a Sexta'"}

									{if="$idespaco == $value.idespaco"}
										<tr style="height: 70px;">
											<td style="border: solid 1px; text-align: center; padding: 5px; width: 160px; ">
													{$value.descturma}<br>
													{$value.apelidoperson} / Estagiário<br>
													<span style="font-weight: bold;">
														{$value.horainicio} às {$value.horatermino}
													</span>
													<br>{$value.diasemana}-{$value.periodo}					
											</td>
										</tr>
									{/if}

								{/if}

							{/if}
						{/loop}
						</table>						
					</td>
					<td >
						<table>						
						{$idespaco = $value.idespaco}
						{loop="$turmas"}
							{if="$value.periodo == 'Manhã'"}

								{if="$value.diasemana == 'Quarta' OR $value.diasemana == 'Segunda e Quarta' OR $value.diasemana == 'Quarta e Sexta' OR $value.diasemana == 'Quarta a Sexta'"}

									{if="$idespaco == $value.idespaco"}
										<tr style="height: 70px;">
											<td style="border: solid 1px; text-align: center; padding: 5px; width: 160px; ">
													{$value.descturma}<br>
													{$value.apelidoperson} / Estagiário<br>
													<span style="font-weight: bold;">
														{$value.horainicio} às {$value.horatermino}
													</span>
													<br>{$value.diasemana}-{$value.periodo}					
											</td>
										</tr>
									{/if}

								{/if}

							{/if}
						{/loop}
						</table>						
					</td>
				</tr>
			</tbody>

			<thead>
				<tr>
					<th>
						
					</th>
					<th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px; width: 160px; background-color: #ccc;">
						SEGUNDA-FEIRA
					</th>
					<th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px; width: 160px; background-color: #ccc;">
						TERÇA-FEIRA
					</th>
					<th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px; width: 160px; background-color: #ccc;">
						QUARTA-FEIRA
					</th>
					<th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px; width: 160px; background-color: #ccc;">
						QUINTA-FEIRA
					</th>
					<th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px; width: 160px; background-color: #ccc;">
						SEXTA-FEIRA
					</th>
					<th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px; width: 160px; background-color: #ccc;">
						SÁBADO
					</th>
					<th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px; width: 160px; background-color: #ccc;">
						DOMINGO
					</th>
				</tr>
				
			</thead>
			<tbody>
				<tr>

					<td>
						 <br>
						T<br><br>
						A<br><br>
						R<br><br>
						D<br><br>
						E<br><br>
						 
					</td>
					<td >
						<table>
						{loop="$turmas"}
						{if="$value.periodo == 'Tarde'"}

							{if="$value.diasemana == 'Segunda a Sexta' OR $value.diasemana == 'Segunda'"}

								{if="$idespaco == $value.idespaco"}

									<tr style="height: 70px;">
										<td style="border: solid 1px; text-align: center; padding: 5px; width: 160px; ">

											

												{$value.descturma}<br>
												{$value.apelidoperson} / Estagiário<br>
												<span style="font-weight: bold;">
													{$value.horainicio} às {$value.horatermino}
												</span>
												<br>{$value.diasemana}-{$value.periodo}
											
										</td>
									</tr>
								{/if}

							{/if}

						{/if}
						{/loop}
						
						</table>
						
					</td>
				</tr>
			</tbody>

			<thead>
				<tr>
					<th>
						
					</th>
					<th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px; width: 160px; background-color: #ccc;">
						SEGUNDA-FEIRA
					</th>
					<th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px; width: 160px; background-color: #ccc;">
						TERÇA-FEIRA
					</th>
					<th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px; width: 160px; background-color: #ccc;">
						QUARTA-FEIRA
					</th>
					<th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px; width: 160px; background-color: #ccc;">
						QUINTA-FEIRA
					</th>
					<th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px; width: 160px; background-color: #ccc;">
						SEXTA-FEIRA
					</th>
					<th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px; width: 160px; background-color: #ccc;">
						SÁBADO
					</th>
					<th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px; width: 160px; background-color: #ccc;">
						DOMINGO
					</th>
				</tr>
				
			</thead>
			<tbody>
				<tr>

					<td>
						 <br>
						N<br><br>
						O<br><br>
						I<br><br>
						T<br><br>
						E<br><br>
						 
					</td>
					<td >
						<table>
						{loop="$turmas"}
						{if="$value.periodo == 'Noite'"}

							{if="$value.diasemana == 'Segunda a Sexta' OR $value.diasemana == 'Segunda'"}

								{if="$idespaco == $value.idespaco"}

									<tr 	style="height: 70px;">
										<td style="border: solid 1px; text-align: center; padding: 5px; width: 160px; font-display: auto;">

											

												{$value.descturma}<br>
												{$value.apelidoperson} / Estagiário<br>
												<span style="font-weight: bold;">
													{$value.horainicio} às {$value.horatermino}
												</span>
												<br>{$value.diasemana}-{$value.periodo}
											
										</td>
									</tr>
								{/if}

							{/if}

						{/if}
						{/loop}
						</table>
						
					</td>
				</tr>
			</tbody>

			 				
		</table>

		<button
        class="btn btn-primary"
        id="export-button"
        onclick="exportTableToXLS()"
      >
        Exportar para XLS
      </button>

      <button onclick="window.print()" class="btn btn-primary" style="">
                    <i class="fa fa-print"></i> Imprimir
              </button>

        {else}

        <div style="text-align: center; color: red; font-weight: bold; font-size: 24px;">
        	Não há espaços cadastrados para o local selecionado.
        </div>
        
        			
        	
		
		{/loop}

		
        
	</div>
	
	<script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <script type="text/javascript">
      
      function exportTableToXLS() {

        const table = document.getElementById("table");
        const tableRows = table.getElementsByTagName("tr");
        const columnCount = tableRows[0].children.length;

        const worksheet = XLSX.utils.table_to_sheet(table);

        const workbook = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(
          workbook,
          worksheet,
          document.getElementById("title").textContent
        );

        const fileName = document.getElementById("title").textContent+".xlsx";

        XLSX.writeFile(workbook, fileName);
      }


    </script>
