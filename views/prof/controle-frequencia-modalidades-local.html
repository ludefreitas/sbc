<head>
    <!-- Required meta tags -->   
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css"
      integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
      crossorigin="anonymous"
    />

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">

    <link rel="stylesheet" type="text/css" href="/../res/site/css/style.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.11/jquery.mask.min.js"></script>

    <title>Cursos Esportivos SBC</title>
    <link rel="icon" type="image/jpg" href="/../res/site/img/corpoacao.png" />
    
    <script type="text/javascript">

      function sumQuantity() {

        var elements = document.getElementsByClassName('itemTable');
        var sum = 0;

        for (i = 0; i < elements.length; i++) {
          sum = sum + parseFloat(elements[i].innerHTML);
        };

        alert(sum);
      }
      
      

    </script>

    <style type="text/css">
     
    @media print{
      @page{
          size: landscape;
      }
        #image-example{
            position: absolute;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            margin: auto;
      }
    }

    .div-center {
      padding: 20px;
      margin: 10px;
      border: solid 1px rgb(219, 219, 219);
    }

      /*
      @page land {
        size: landscape;
      }
        #landscape {
        page: land;
      }
      */

      body {
          margin: 10px;
          padding: 20px;
      }

       #div1 {
          display: flex;
      }

    

      table {          
          
          font-size: 8px; 
          border: 1px solid #000;
          flex-shrink:0;
          page-break-inside: avoid; 
      }
      tr:nth-child(even){
          background: lightgray;
      }
      

    </style>

</head>

<div id="div1">  
    <a href="javascript:window.history.go(-1)">
        <i class="fa fa-arrow-left"></i> 
            Voltar
    </a> 
    &nbsp;&nbsp;&nbsp;&nbsp;
    <a href="/prof">
        <i class="fa fa-home"></i> 
            Início
    </a>  
</div>
<hr>

<div class="col-md-12">
  
  {loop="$modalidades"}
      <a href="/prof/controle-frequencia-por-modalidade-local/{$temporada.idtemporada}/{$value.idmodal}/{$idlocal}"><i class=""></i>{$value.descmodal} </a>&nbsp;&nbsp;&nbsp;&nbsp;
  {/loop}

</div>

<hr>

<div id="div1">

  <div class="div-center rounded">
    <h5>CONTROLE DE FREQUÊNCIA {$modalidade} - {$temporada.desctemporada} </h5>
    <h5 id="title" hidden>{$modalidade}_{$temporada.desctemporada} </h5>


        
      <table class="table table-bordered" id="table">
        
        <thead>
            <tr>
              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">ID</th>
              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">LOCAL</th>
              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">ESPAÇO</th>
              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">PROFESSOR</th>
              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">PROGRAMA</th>
        
              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">MODALIDADE</th>

              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">DIAS</th>

              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">PERÍODO</th>

              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">HORÁRIO</th>
              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">IDADE</th>
              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">ORIGEM</th>
              <th class="itemTable" style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">VAGAS</th>
              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">MATR.</th>
              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">ESPERA</th>
              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">INSCR.</th> 
              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">JAN</th>  
              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">FEV</th>
              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">MAR</th>
              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">ABR</th>
              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">MAI</th>
              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">JUN</th>
              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">JUL</th>
              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">AGO</th>
              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">SET</th>
              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">OUT</th>
              <th style="border: solid 1px; text-align: center; font-weight: bold; padding: 5px;">NOV</th>
            </tr>
        </thead>
        {loop="$turmas"}
        <tbody>
          <tr style="padding: 5px"> 
              <td style="text-align: center; border: solid 1px; padding: 5px;">
               {$value.idturma}
              </td>                                      
              <td style="text-align: center; border: solid 1px; padding: 5px;">
               {$value.apelidolocal}
              </td>                         
              <td style="text-align: center; border: solid 1px; color: darkblue; padding: 5px;">
               {$value.descespaco}
              </td>
              <td style="text-align: center; border: solid 1px; padding: 5px;">
                {if="$value.idperson == 7"}
                SBC
                {else}
               {$value.apelidoperson}
               {/if}
              </td>              
              <td style="text-align: center; border: solid 1px; color: darkblue; padding: 5px;">
               {$value.prograativ}
              </td>
              <td style="text-align: center; border: solid 1px; padding: 5px;">
               {$value.descativ}
              </td>
              <td style="text-align: center; border: solid 1px; color: darkblue; padding: 5px;">
               {$value.diasemana}
              </td>
              <td style="text-align: center; border: solid 1px; padding: 5px;">
               {$value.periodo}
              </td> 
              <td style="text-align: center; border: solid 1px; color: darkblue; padding: 5px;">
               {$value.horainicio} às {$value.horatermino}
              </td>
              <td style="text-align: center; border: solid 1px; padding: 5px;">
               {$value.initidade} à {$value.fimidade}
              </td>              
              <td style="text-align: center; border: solid 1px; color: darkblue; padding: 5px;">
               {$value.origativ}
              </td>
              <td style="text-align: center; border: solid 1px; padding: 5px;">
               {$value.vagas+$value.vagaslaudo+$value.vagaspcd+$value.vagaspvs}
              </td>
              <td style="text-align: center; border: solid 1px; padding: 5px;">
               {$value.nummatriculados}
              </td>  
              <td style="text-align: center; border: solid 1px; padding: 5px;">
               {function="getNumInscListaEsperaTurmaTemporada($value.idtemporada, $value.idturma)"}
              </td> 
              <td style="text-align: center; border: solid 1px; color: darkblue; padding: 5px;">
               {function="ControleFrequenciaAnoAnt($value.idturma, $value.idtemporada, $value.desctemporada)"}
              </td> 
              <td style="text-align: center; border: solid 1px; padding: 5px;">  
                <a style="color: black;" href="/prof/insc-turma-temporada-chamada-mensal/{$value.idtemporada}/{$value.idturma}/{$value.desctemporada}-01-01">                             
                {function="ControleFrequenciaJan($value.idturma, $value.idtemporada, $value.desctemporada)"}    </a> 
              </td>             
              <td style="text-align: center; border: solid 1px; padding: 5px;"> 
              <a style="color: black;" href="/prof/insc-turma-temporada-chamada-mensal/{$value.idtemporada}/{$value.idturma}/{$value.desctemporada}-02-01">                              
                {function="ControleFrequenciaFev($value.idturma, $value.idtemporada, $value.desctemporada)"}     </a>
              </td>
              <td style="text-align: center; border: solid 1px; padding: 5px;">   
              <a style="color: black;" href="/prof/insc-turma-temporada-chamada-mensal/{$value.idtemporada}/{$value.idturma}/{$value.desctemporada}-03-01">                            
                {function="ControleFrequenciaMar($value.idturma, $value.idtemporada, $value.desctemporada)"}     </a>
              </td>      
              <td style="text-align: center; border: solid 1px; padding: 5px;">
              <a style="color: black;" href="/prof/insc-turma-temporada-chamada-mensal/{$value.idtemporada}/{$value.idturma}/{$value.desctemporada}-04-01">                               
                {function="ControleFrequenciaAbr($value.idturma, $value.idtemporada, $value.desctemporada)"}     </a>
              </td> 
              <td style="text-align: center; border: solid 1px; padding: 5px;">   
              <a style="color: black;" href="/prof/insc-turma-temporada-chamada-mensal/{$value.idtemporada}/{$value.idturma}/{$value.desctemporada}-05-01">                            
                {function="ControleFrequenciaMai($value.idturma, $value.idtemporada, $value.desctemporada)"}     </a>
              </td>     
              <td style="text-align: center; border: solid 1px; padding: 5px;">  
              <a style="color: black;" href="/prof/insc-turma-temporada-chamada-mensal/{$value.idtemporada}/{$value.idturma}/{$value.desctemporada}-06-01">                              
                {function="ControleFrequenciaJun($value.idturma, $value.idtemporada, $value.desctemporada)"}  </a>   
              </td>   
              <td style="text-align: center; border: solid 1px; padding: 5px;">  
              <a style="color: black;" href="/prof/insc-turma-temporada-chamada-mensal/{$value.idtemporada}/{$value.idturma}/{$value.desctemporada}-07-01">                              
                {function="ControleFrequenciaJul($value.idturma, $value.idtemporada, $value.desctemporada)"}  </a>   
              </td>    
              <td style="text-align: center; border: solid 1px; padding: 5px;">  
              <a style="color: black;" href="/prof/insc-turma-temporada-chamada-mensal/{$value.idtemporada}/{$value.idturma}/{$value.desctemporada}-08-01">                
                {function="ControleFrequenciaAgo($value.idturma, $value.idtemporada, $value.desctemporada)"}    </a> 
              </td> 
              <td style="text-align: center; border: solid 1px; padding: 5px;">   
              <a style="color: black;" href="/prof/insc-turma-temporada-chamada-mensal/{$value.idtemporada}/{$value.idturma}/{$value.desctemporada}-09-01">               
                {function="ControleFrequenciaSet($value.idturma, $value.idtemporada, $value.desctemporada)"}     </a>
              </td> 
              <td style="text-align: center; border: solid 1px; padding: 5px;">   
              <a style="color: black;" href="/prof/insc-turma-temporada-chamada-mensal/{$value.idtemporada}/{$value.idturma}/{$value.desctemporada}-10-01">               
                {function="ControleFrequenciaOut($value.idturma, $value.idtemporada, $value.desctemporada)"}    </a> 
              </td>   
              <td style="text-align: center; border: solid 1px; padding: 5px;">                
              <a style="color: black;" href="/prof/insc-turma-temporada-chamada-mensal/{$value.idtemporada}/{$value.idturma}/{$value.desctemporada}-11-01">  {function="ControleFrequenciaNov($value.idturma, $value.idtemporada, $value.desctemporada)"}  </a>   
              </td>
          </tr>
          </tbody>
          {else}
          <tr style="font-weight: bold; color: red; font-size: 22px; text-align: center; padding: 10px;">
            <td colspan="26" style="padding: 10px">
              Não há turmas relacionadas a este local!
            </td>
          </tr>
          </tbody>
          {/loop}
        </tbody>
      </table>

      <button
        class="btn btn-primary"
        id="export-button"
        onclick="exportTableToXLS()"
      >
        Exportar para XLS
      </button>

      <button onclick="window.print()" class="btn btn-primary" style="">
                    <i class="fa fa-print"></i> Imprimir
              </button>
    </div>

</div>

<script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <script type="text/javascript">
      
      function exportTableToXLS() {

        const table = document.getElementById("table");
        const tableRows = table.getElementsByTagName("tr");
        const columnCount = tableRows[0].children.length;

        const worksheet = XLSX.utils.table_to_sheet(table);

        const workbook = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(
          workbook,
          worksheet,
          document.getElementById("title").textContent
        );

        const fileName = document.getElementById("title").textContent+".xlsx";

        XLSX.writeFile(workbook, fileName);
      }


    </script>





      
           
            
           
           